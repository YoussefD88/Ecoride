<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Covoiturages - EcoRide</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light shadow-sm">
    <div class="container">
      <a class="navbar-brand text-success fw-bold" href="index.html">EcoRide</a>
      <div class="collapse navbar-collapse">
        <ul class="navbar-nav ms-auto">
          <li class="nav-item"><a class="nav-link" href="index.html">Accueil</a></li>
          <li class="nav-item"><a class="nav-link active" href="#">Covoiturages</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Connexion</a></li>
          <li class="nav-item"><a class="nav-link" href="#">Contact</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <main class="container my-5">
    <h1 class="mb-4">RÃ©sultats des covoiturages</h1>

    <div class="row mb-4">
      <div class="col-md-3">
        <label class="form-label">Voyage Ã©cologique</label>
        <select class="form-select" id="filtre-eco">
          <option value="">Tous</option>
          <option value="true">Oui</option>
          <option value="false">Non</option>
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">Prix maximum (â‚¬)</label>
        <input type="number" class="form-control" id="filtre-prix" placeholder="ex : 25">
      </div>
      <div class="col-md-3">
        <label class="form-label">DurÃ©e max (h)</label>
        <input type="number" class="form-control" id="filtre-duree">
      </div>
      <div class="col-md-3">
        <label class="form-label">Note minimale</label>
        <input type="number" class="form-control" id="filtre-note" step="0.1" min="0" max="5">
      </div>
    </div>

    <div id="resultats-covoiturages">
      <!-- RÃ©sultats JS -->
    </div>
  </main>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const depart = urlParams.get("depart");
    const arrivee = urlParams.get("arrivee");
    const date = urlParams.get("date");

    const trajets = [
      {
        pseudo: "JulieB",
        photo: "https://randomuser.me/api/portraits/women/44.jpg",
        note: 4.8,
        places: 2,
        prix: 15,
        date: date,
        heure_depart: "08:00",
        heure_arrivee: "10:00",
        ecologique: true,
        duree: 2,
        vehicule: "Renault Zoe - Ã©lectrique",
        lien: "details.html?id=1"
      },
      
    ];

    function afficherTrajets() {
      const container = document.getElementById("resultats-covoiturages");
      container.innerHTML = "";

      const filtreEco = document.getElementById("filtre-eco").value;
      const filtrePrix = parseFloat(document.getElementById("filtre-prix").value);
      const filtreDuree = parseFloat(document.getElementById("filtre-duree").value);
      const filtreNote = parseFloat(document.getElementById("filtre-note").value);

      const filtres = trajets.filter(t => {
        return t.places > 0 &&
          (filtreEco === "" || String(t.ecologique) === filtreEco) &&
          (isNaN(filtrePrix) || t.prix <= filtrePrix) &&
          (isNaN(filtreDuree) || t.duree <= filtreDuree) &&
          (isNaN(filtreNote) || t.note >= filtreNote);
      });

      if (filtres.length === 0) {
        container.innerHTML = `<div class='alert alert-warning'>Aucun trajet trouvÃ© pour cette date. Essayez une autre date.</div>`;
        return;
      }

      filtres.forEach(t => {
        container.innerHTML += `
          <div class="card mb-3">
            <div class="card-body d-flex align-items-center">
              <img src="${t.photo}" class="rounded-circle me-3" width="60" height="60" alt="${t.pseudo}">
              <div class="flex-grow-1">
                <h5>${t.pseudo} <small class="text-muted">${t.note} â˜…</small></h5>
                <p>${t.date} | ${t.heure_depart} - ${t.heure_arrivee}</p>
                <p>${t.places} places restantes - ${t.prix}â‚¬</p>
                <p><strong>${t.ecologique ? "âœ… Voyage Ã©cologique" : "ðŸš— Classique"}</strong></p>
              </div>
              <a href="${t.lien}" class="btn btn-success">DÃ©tail</a>
            </div>
          </div>
        `;
      });
    }

    document.querySelectorAll("#filtre-eco, #filtre-prix, #filtre-duree, #filtre-note").forEach(input => {
      input.addEventListener("input", afficherTrajets);
    });

    window.addEventListener("DOMContentLoaded", afficherTrajets);
  </script>
</body>
</html>
